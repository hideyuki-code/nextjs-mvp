# 🔄 フェーズ4：ISRとデータ取得（10h）

## 📋 フェーズ概要

ISR（Incremental Static Regeneration）の仕組みを理解し、効率的なデータ取得システムを構築します。

## 🎯 学習目標

- [ ] ISRの仕組みと利点を理解
- [ ] generateStaticParams の使い方を理解
- [ ] JSONデータを使った記事管理システムの構築
- [ ] 404・notFoundハンドリングの実装

---

## 🎫 チケット一覧

### 📚 TICKET-4-1：ISRの仕組み（generateStaticParams, revalidate）を理解する

**⏰ 予想時間：** 2h  
**📊 進捗：** 
- [ ] 実装完了
- [ ] 検証完了  
- [ ] 知識定着完了

**🎯 理解すべき質問（これらに答えられるようになることが目標）：**

**ISRの基本概念**
- Q1: ISR（Incremental Static Regeneration）とは何ですか？
- Q2: 従来のSSGとISRの違いは何ですか？
- Q3: ISRのメリットとデメリットは何ですか？
- Q4: どのような場面でISRを使うべきですか？
- Q5: Next.js 14でのISRの改善点は何ですか？

**generateStaticParams**
- Q6: `generateStaticParams` の役割は何ですか？
- Q7: `generateStaticParams` はいつ実行されますか？
- Q8: `generateStaticParams` で返されなかったパラメータはどうなりますか？
- Q9: 大量のページがある場合、`generateStaticParams` の最適化方法は？
- Q10: Next.js 14での `generateStaticParams` の改善点は？

**revalidate設定**
- Q11: `revalidate` オプションは何を制御しますか？
- Q12: `revalidate: 3600` は何を意味しますか？
- Q13: `revalidate: false` と `revalidate: 0` の違いは何ですか？
- Q14: On-demand revalidationとは何ですか？
- Q15: Next.js 14でのキャッシュ戦略の変更点は？

**実務での使い分け**
- Q16: ブログサイトの記事ページにISRを使うべきですか？
- Q17: 商品カタログページにISRを使う際の注意点は？
- Q18: ニュースサイトでISRを使う場合の最適な revalidate 時間は？

**パフォーマンスとの関係**
- Q19: ISRはサーバー負荷にどう影響しますか？
- Q20: CDNとISRの関係は？
- Q21: ISRを使った場合のキャッシュ戦略は？

**📝 実装手順：**
1. Next.js公式ドキュメントでISRを調査
2. generateStaticParamsの仕組みを理解
3. revalidateオプションの動作を確認
4. ChatGPT Webで知識を整理・言語化

**✅ 検証方法：**
- 上記の質問21つすべてに具体的に答えられる
- 実際のプロジェクトでISRを適切に実装できる
- revalidate時間を適切に設定できる
- 静的生成と動的レンダリングの使い分けができる
- ISRのパフォーマンス特性を理解している
- Next.js 14での改善点を活用できる

**💭 学習メモ：**
```
[ここに学習で得た知識を記録]
```

---

### 🔨 TICKET-4-2：JSONファイル（/data/posts.json）からのデータ取得機能を実装

**⏰ 予想時間：** 2.5h  
**📊 進捗：** 
- [ ] 実装完了
- [ ] 検証完了  
- [ ] 知識定着完了

**🎯 実装内容：**
- 記事データのJSONファイル作成
- データ取得関数の実装
- TypeScript型定義の作成
- データ取得のユーティリティ関数

**📝 実装手順：**
1. `/data/posts.json` にサンプル記事データを作成
2. 記事データの型定義を作成
3. データ取得関数 `getPosts()`, `getPost(slug)` を実装
4. エラーハンドリングを追加

**✅ 検証方法：**
- [ ] JSONファイルから記事データを取得できる
- [ ] TypeScript型定義が正しく適用される
- [ ] エラーハンドリングが正常に動作する
- [ ] データ取得関数が再利用可能

**💭 実装メモ：**
```
[実装時の気づきや問題点を記録]
```

---

### 🔨 TICKET-4-3：記事一覧（/posts）と記事詳細（/posts/[slug]）でISR適用

**⏰ 予想時間：** 3h  
**📊 進捗：** 
- [ ] 実装完了
- [ ] 検証完了  
- [ ] 知識定着完了

**🎯 実装内容：**
- 記事一覧ページの実装
- 記事詳細ページの実装
- ISRによる静的生成の実装
- generateStaticParamsの実装

**📝 実装手順：**
1. `/posts/page.tsx` に記事一覧ページを実装
2. `/posts/[slug]/page.tsx` に記事詳細ページを実装
3. generateStaticParamsを実装
4. revalidateオプションを設定

**✅ 検証方法：**
- [ ] 記事一覧ページが正常に表示される
- [ ] 記事詳細ページが正常に表示される
- [ ] ISRによる静的生成が動作する
- [ ] generateStaticParamsが正しく動作する

**💭 実装メモ：**
```
[実装時の気づきや問題点を記録]
```

---

### 📚 TICKET-4-4：動的ルートにおける404とnotFound処理の違いを理解する

**⏰ 予想時間：** 2.5h  
**📊 進捗：** 
- [ ] 実装完了
- [ ] 検証完了  
- [ ] 知識定着完了

**🎯 学習内容：**
- 404ページとnotFound()関数の違い
- 動的ルートでのエラーハンドリング
- not-found.tsxの実装
- カスタム404ページの作成

**📝 実装手順：**
1. Next.js のエラーハンドリングを調査
2. not-found.tsxページを作成
3. 動的ルートでnotFound()関数を実装
4. カスタム404ページを作成

**✅ 検証方法：**
- [ ] 存在しない記事でnotFound()が呼ばれる
- [ ] カスタム404ページが表示される
- [ ] 適切なHTTPステータスコードが返される
- [ ] SEOに配慮した404ページが実装される

**💭 実装メモ：**
```
[実装時の気づきや問題点を記録]
```

---

## 🎓 フェーズ4完了チェック

**すべてのチケットが完了したら以下を確認：**

- [ ] ISRの仕組みを理解している
- [ ] generateStaticParamsを使えるようになっている
- [ ] JSONデータからの記事管理システムが動作している
- [ ] 適切なエラーハンドリングが実装されている
- [ ] パフォーマンス最適化が適用されている

**🎯 次のステップ：**
[phase5-mvp-build.md](./phase5-mvp-build.md) に進む

---

**開始日：** [日付を記入]  
**完了日：** [日付を記入]  
**実際の所要時間：** [時間を記入] 